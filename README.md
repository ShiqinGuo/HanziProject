# æ±‰å­—åˆ†æå·¥å…·

è¿™æ˜¯ä¸€ä¸ªç”¨äºå¤„ç†å’Œåˆ†ææ±‰å­—å›¾åƒæ•°æ®çš„å·¥å…·é›†ï¼Œå¯ä»¥è¿›è¡Œè¯†åˆ«ã€åˆ†ç±»å’Œæ•°æ®å¯¼å…¥å¯¼å‡ºã€‚

## ğŸ“‹ ç›®å½•

    - [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
    - [åŠŸèƒ½ç‰¹æ€§](#åŠŸèƒ½ç‰¹æ€§)
    - [æŠ€æœ¯æ¶æ„](#æŠ€æœ¯æ¶æ„)
    - [é¡¹ç›®ç»“æ„](#é¡¹ç›®ç»“æ„)
    - [å®‰è£…éƒ¨ç½²](#å®‰è£…éƒ¨ç½²)
    - [åŠŸèƒ½è¯¦è§£](#åŠŸèƒ½è¯¦è§£)
    - [æ•°æ®æ¨¡å‹](#æ•°æ®æ¨¡å‹)
    - [APIæ¥å£](#apiæ¥å£)
    - [æ€§èƒ½ä¼˜åŒ–](#æ€§èƒ½ä¼˜åŒ–)
    - [é…ç½®è¯´æ˜](#é…ç½®è¯´æ˜)
    - [è´¡çŒ®æŒ‡å—](#è´¡çŒ®æŒ‡å—)
    - [è®¸å¯è¯](#è®¸å¯è¯)

## ğŸ“ é¡¹ç›®æ¦‚è¿°

æ±‰å­—æ•™å­¦ç®¡ç†ç³»ç»Ÿæ—¨åœ¨æä¾›ä¸€ä¸ªé«˜æ•ˆã€ç”¨æˆ·å‹å¥½çš„å¹³å°ï¼Œç”¨äºæ±‰å­—çš„ç®¡ç†ã€å­¦ä¹ å’Œæ•™å­¦ã€‚ç³»ç»Ÿé›†æˆäº†å¤šç§å…ˆè¿›æŠ€æœ¯ï¼Œå¦‚OCRè¯†åˆ«ã€å›¾åƒç›¸ä¼¼åº¦æ¯”è¾ƒã€æ±‰å­—ç¬”ç”»åˆ†æç­‰ï¼Œä¸ºç”¨æˆ·æä¾›å…¨æ–¹ä½çš„æ±‰å­—å­¦ä¹ ä½“éªŒã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ ¸å¿ƒåŠŸèƒ½

1. **æ±‰å­—ç®¡ç†**
   - æ·»åŠ æ–°æ±‰å­—è®°å½•
   - ç¼–è¾‘å·²æœ‰æ±‰å­—ä¿¡æ¯
   - æŸ¥çœ‹æ±‰å­—è¯¦ç»†ä¿¡æ¯
   - åˆ é™¤æ±‰å­—è®°å½•

2. **æ±‰å­—æœç´¢**
   - åŸºäºå¤šæ¡ä»¶çš„æ±‰å­—æœç´¢
   - ç¬”ç”»æ•°é‡æœç´¢
   - éƒ¨é¦–æœç´¢
   - æ‹¼éŸ³æœç´¢
   - ç»“æ„æœç´¢

3. **ç¬”ç”»æŸ¥è¯¢ä¸å­¦ä¹ **
   - æ±‰å­—ç¬”ç”»é¡ºåºå±•ç¤º
   - ç¬”ç”»æ•°é‡ç»Ÿè®¡
   - ç¬”ç”»ç±»å‹åˆ†æ

4. **æ•°æ®å¯¼å…¥å¯¼å‡º**
   - æ‰¹é‡å¯¼å…¥æ±‰å­—æ•°æ®
   - å¯¼å‡ºæ±‰å­—æ•°æ®ä¸ºå¤šç§æ ¼å¼

5. **å›¾åƒå¤„ç†ä¸æ¯”è¾ƒ**
   - æ±‰å­—å›¾åƒè¯†åˆ«
   - ç”¨æˆ·ä¹¦å†™ä¸æ ‡å‡†æ±‰å­—æ¯”è¾ƒ
   - ç›¸ä¼¼åº¦åˆ†æ

## ğŸ”§ æŠ€æœ¯æ¶æ„

### åç«¯æŠ€æœ¯æ ˆ

- **æ¡†æ¶**: Django 4.2.11
- **æ•°æ®åº“**: MySQL
- **ç¼“å­˜**: Redis
- **å›¾åƒå¤„ç†**: OpenCV, PIL
- **OCRè¯†åˆ«**: EasyOCR
- **æ·±åº¦å­¦ä¹ **: PyTorch, TorchVision
- **å¼‚æ­¥ä»»åŠ¡**: Concurrent Futures

### å‰ç«¯æŠ€æœ¯æ ˆ

- **è¯­è¨€**: HTML5, CSS3, JavaScript
- **æ¡†æ¶**: jQuery
- **UIç»„ä»¶**: Bootstrap
- **å›¾è¡¨**: Chart.js
- **åŠ¨ç”»**: CSSåŠ¨ç”», SVG

### éƒ¨ç½²ç¯å¢ƒ

- Docker & Docker Compose
- Nginx
- Gunicorn
- MySQL

## ğŸ“ é¡¹ç›®ç»“æ„

```
hanzi_project/
â”œâ”€â”€ hanzi_app/
â”‚   â”œâ”€â”€ data_processor.py  # æ•°æ®å¤„ç†åŠŸèƒ½
â”‚   â”œâ”€â”€ data_importer.py   # æ•°æ®å¯¼å…¥åŠŸèƒ½
â”‚   â””â”€â”€ recognition.py     # æ±‰å­—è¯†åˆ«åŠŸèƒ½
â”œâ”€â”€ hanzi_analyzer.py      # åˆ†ææ±‰å­—æ•°æ®çš„ä¸»è„šæœ¬
â”œâ”€â”€ hanzi_importer.py      # å¯¼å…¥æ±‰å­—æ•°æ®çš„ç¤ºä¾‹è„šæœ¬
â””â”€â”€ README.md              # é¡¹ç›®è¯´æ˜æ–‡æ¡£
```

## ğŸš€ å®‰è£…éƒ¨ç½²

### ç³»ç»Ÿè¦æ±‚

- Python 3.8+
- MySQL 8.0+
- Redis 6.0+
- è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ç”¨äºå­˜å‚¨æ±‰å­—å›¾åƒ
- æ¨è8GBä»¥ä¸ŠRAM (ä½¿ç”¨æ·±åº¦å­¦ä¹ æ¨¡å‹æ—¶)

### ä½¿ç”¨Dockeréƒ¨ç½²

1. å…‹éš†é¡¹ç›®ä»“åº“

        ```bash
        git clone https://github.com/ShiqinGuo/hanzi_project.git
        cd hanzi_project
        ```

2. ä½¿ç”¨Docker Composeæ„å»ºå¹¶å¯åŠ¨æœåŠ¡

        ```bash
        docker-compose up --build
        ```

### æ‰‹åŠ¨éƒ¨ç½²

1. å…‹éš†é¡¹ç›®ä»“åº“

        ```bash
        git clone https://github.com/ShiqinGuo/hanzi_project.git
        cd hanzi_project
        ```

2. åˆ›å»ºå¹¶æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ

        ```bash
        python -m venv venv
        source venv/bin/activate  # Linux/Mac
        venv\Scripts\activate  # Windows
        ```

3. å®‰è£…ä¾èµ–

        ```bash
        pip install -r requirements.txt
        ```

4. é…ç½®æ•°æ®åº“

        ```bash
        # ä¿®æ”¹settings.pyä¸­çš„æ•°æ®åº“è®¾ç½®
        python manage.py migrate
        ```

5. åˆ›å»ºè¶…çº§ç”¨æˆ·

        ```bash
        python manage.py createsuperuser
        ```

6. æ”¶é›†é™æ€æ–‡ä»¶

        ```bash
        python manage.py collectstatic
        ```

7. è¿è¡ŒæœåŠ¡å™¨

        ```bash
        python manage.py runserver
        ```

## ğŸ“š åŠŸèƒ½è¯¦è§£

### 1. æ•°æ®å¤„ç†åŠŸèƒ½

é€šè¿‡ `hanzi_analyzer.py` è„šæœ¬å¯ä»¥å¤„ç†æ±‰å­—å›¾åƒæ•°æ®ï¼Œè¯†åˆ«æ±‰å­—å¹¶ç”ŸæˆExcelæŠ¥å‘Šï¼š

```bash
python hanzi_analyzer.py
```

### 2. æ•°æ®å¯¼å…¥åŠŸèƒ½

é€šè¿‡ `hanzi_importer.py` è„šæœ¬å¯ä»¥å¯¼å…¥ZIPå‹ç¼©çš„å›¾åƒå’ŒJSONæ•°æ®ï¼š

```bash
python hanzi_importer.py
```

ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œæ›´çµæ´»çš„é…ç½®ï¼š

```bash
python -m hanzi_app.data_importer --image_zip path/to/images.zip --json_data path/to/data.json --level_key levels --comment_key comments --output results.xlsx --format excel --test
```

#### å‚æ•°è¯´æ˜ï¼š

- `--image_zip`: å›¾ç‰‡ZIPæ–‡ä»¶è·¯å¾„ï¼ˆå¿…éœ€ï¼‰
- `--json_data`: JSONæ•°æ®æ–‡ä»¶è·¯å¾„ï¼ˆå¿…éœ€ï¼‰
- `--level_key`: JSONä¸­è¡¨ç¤ºç­‰çº§çš„é”®
- `--comment_key`: JSONä¸­è¡¨ç¤ºè¯„è¯­çš„é”®
- `--output`: è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼ˆå¿…éœ€ï¼‰
- `--format`: è¾“å‡ºæ ¼å¼ï¼Œå¯é€‰å€¼ä¸ºexcelæˆ–jsonï¼Œé»˜è®¤ä¸ºexcel
- `--test`: æµ‹è¯•æ¨¡å¼æ ‡å¿—ï¼Œæ·»åŠ æ­¤å‚æ•°å°†åªå¤„ç†å‰5å¼ å›¾ç‰‡

#### é”®æ˜ å°„è¯´æ˜ï¼š

å¯ä»¥é€šè¿‡`key_mappings`é…ç½®JSONæ•°æ®ä¸­é”®ä¸è¾“å‡ºç»“æœå­—æ®µçš„æ˜ å°„å…³ç³»ï¼Œä¾‹å¦‚ï¼š

```python
key_mappings = {
    "comment": "comments",  # JSONä¸­çš„commentsé”®æ˜ å°„åˆ°ç»“æœä¸­çš„comment
    "level": "levels"       # JSONä¸­çš„levelsé”®æ˜ å°„åˆ°ç»“æœä¸­çš„level
}
```

#### è¾“å‡ºæ ¼å¼ï¼š

- Excelæ ¼å¼ï¼šç”ŸæˆåŒ…å«æ±‰å­—è¯†åˆ«ç»“æœã€ç­‰çº§ã€è¯„è¯­ç­‰ä¿¡æ¯çš„è¡¨æ ¼
- JSONæ ¼å¼ï¼šç”ŸæˆåŒ…å«ç›¸åŒä¿¡æ¯çš„JSONæ–‡ä»¶

## ğŸ’¾ æ•°æ®æ¨¡å‹

### Hanziæ¨¡å‹

    ```python
        class Hanzi(models.Model):
        STRUCTURE_CHOICES = [
                ('æœªçŸ¥ç»“æ„', 'æœªçŸ¥ç»“æ„'),
                ('å·¦å³ç»“æ„', 'å·¦å³ç»“æ„'),
                ('ä¸Šä¸‹ç»“æ„', 'ä¸Šä¸‹ç»“æ„'),
                ('åŒ…å›´ç»“æ„', 'åŒ…å›´ç»“æ„'),
                ('ç‹¬ä½“ç»“æ„', 'ç‹¬ä½“ç»“æ„'),
                ('å“å­—ç»“æ„', 'å“å­—ç»“æ„'),
                ('ç©¿æ’ç»“æ„', 'ç©¿æ’ç»“æ„'),
        ]
        VARIANT_CHOICES = [
                ('ç®€ä½“', 'ç®€ä½“'),
                ('ç¹ä½“', 'ç¹ä½“'),
        ]
        LEVEL_CHOICES = [
                ('A', 'A'),
                ('B', 'B'),
                ('C', 'C'),
        ]

        id = models.CharField('ç¼–å·', primary_key=True, max_length=5)
        character = models.CharField('æ±‰å­—', max_length=1)  
        image_path = models.CharField('å›¾ç‰‡è·¯å¾„', max_length=255)
        stroke_count = models.IntegerField('ç¬”ç”»æ•°')
        structure = models.CharField('ç»“æ„ç±»å‹', max_length=20, choices=STRUCTURE_CHOICES, default='æœªçŸ¥ç»“æ„')
        stroke_order = models.CharField('ç¬”é¡º', max_length=100, blank=True, null=True)
        pinyin = models.CharField('æ‹¼éŸ³', max_length=50, blank=True, null=True)
        level = models.CharField('ç­‰çº§', max_length=1, choices=LEVEL_CHOICES)
        comment = models.TextField('è¯„è¯­', blank=True, null=True)
        variant = models.CharField('ç®€ç¹ä½“', max_length=10, choices=VARIANT_CHOICES, default='ç®€ä½“')
        standard_image = models.CharField('æ ‡å‡†å›¾ç‰‡è·¯å¾„', max_length=255, blank=True, null=True)
        crt_time = models.DateTimeField('åˆ›å»ºæ—¶é—´', auto_now_add=True)
        upd_time = models.DateTimeField('æ›´æ–°æ—¶é—´', auto_now=True)

        class Meta:
                managed = True  # å¯ç”¨è¿ç§»ç®¡ç†
                db_table = 'hanzi'
                verbose_name = 'æ±‰å­—æ•°æ®'
                verbose_name_plural = 'æ±‰å­—æ•°æ®'
    ```

## ğŸ”Œ APIæ¥å£

### 1. ç¬”ç”»æ•°æ¥å£

- **URL**: `/api/stroke_count/<char>/`
- **æ–¹æ³•**: GET
- **åŠŸèƒ½**: è·å–æŒ‡å®šæ±‰å­—çš„ç¬”ç”»æ•°
- **è¿”å›æ ¼å¼**: JSON
- **ç¼“å­˜**: 15åˆ†é’Ÿ

### 2. æ±‰å­—æ·»åŠ æ¥å£

- **URL**: `/api/add_hanzi/`
- **æ–¹æ³•**: POST
- **åŠŸèƒ½**: æ·»åŠ æ–°æ±‰å­—
- **å‚æ•°**: character, pinyin, stroke_countç­‰
- **å®‰å…¨**: CSRFè±å…(éœ€å‰ç«¯è®¤è¯)

### 3. ç¬”ç”»æœç´¢æ¥å£

- **URL**: `/api/stroke_search/`
- **æ–¹æ³•**: POST
- **åŠŸèƒ½**: æ ¹æ®ç¬”ç”»ç‰¹å¾æœç´¢æ±‰å­—
- **å‚æ•°**: stroke_types(ç¬”ç”»ç±»å‹æ•°ç»„)
- **è¿”å›**: åŒ¹é…æ±‰å­—åˆ—è¡¨

## ğŸš„ æ€§èƒ½ä¼˜åŒ–

1. **æ•°æ®åº“ä¼˜åŒ–**
   - å­—æ®µç´¢å¼•(character, pinyin, stroke_count)
   - æŸ¥è¯¢ä¼˜åŒ–

2. **ç¼“å­˜ç­–ç•¥**
   - ç¬”ç”»æ•°APIç»“æœç¼“å­˜(15åˆ†é’Ÿ)
   - ä¼šè¯ç¼“å­˜(24å°æ—¶)
   - é¡µé¢ç¼“å­˜

3. **å›¾åƒå¤„ç†ä¼˜åŒ–**
   - å¼‚æ­¥ç”Ÿæˆæ ‡å‡†å›¾åƒ
   - å¤šçº¿ç¨‹å¤„ç†æ‰¹é‡å›¾åƒ
   - å›¾åƒå‹ç¼©ä¸æ ¼å¼ä¼˜åŒ–

4. **å‰ç«¯æ€§èƒ½**
   - é™æ€èµ„æºå‹ç¼©
   - æ‡’åŠ è½½å›¾åƒ
   - AJAXåˆ†é¡µå‡å°‘é¡µé¢åˆ·æ–°

## âš™ï¸ é…ç½®è¯´æ˜

### å…³é”®é…ç½®é¡¹

1. **æ•°æ®åº“é…ç½®**

        ```python
        DATABASES = {
            'default': {
                'ENGINE': 'django.db.backends.mysql',
                'NAME': 'hanzi_db',
                'USER': 'hanzi_user',
                'PASSWORD': 'password',
                'HOST': 'db',
                'PORT': '3306',
            }
        }
        ```

2. **ç¼“å­˜é…ç½®**

        ```python
        CACHES = {
            'default': {
                'BACKEND': 'django.core.cache.backends.redis.RedisCache',
                'LOCATION': 'redis://redis:6379/1',
            }
        }
        SESSION_ENGINE = 'django.contrib.sessions.backends.cache'
        SESSION_CACHE_ALIAS = 'default'
        SESSION_COOKIE_AGE = 86400  # 24å°æ—¶
        ```

3. **åª’ä½“å’Œé™æ€æ–‡ä»¶é…ç½®**

        ```python
        MEDIA_URL = '/media/'
        MEDIA_ROOT = os.path.join(BASE_DIR, 'media')
        STATIC_URL = '/static/'
        STATIC_ROOT = os.path.join(BASE_DIR, 'staticfiles')
        ```

4. **å®‰å…¨é…ç½®**

        ```python
        # å¼€å‘ç¯å¢ƒè®¾ç½®
        if DEBUG:
            SECURE_SSL_REDIRECT = False
            SESSION_COOKIE_SECURE = False
            CSRF_COOKIE_SECURE = False
            SECURE_HSTS_SECONDS = 0
            SECURE_HSTS_INCLUDE_SUBDOMAINS = False
            SECURE_HSTS_PRELOAD = False
        ```

## ğŸ“ è”ç³»æ–¹å¼

- é¡¹ç›®åˆ›å»ºäºº: éƒ­å£«é’¦
- ç”µå­é‚®ä»¶: <1158220122@stu.jiangnan.edu.cn>
- é¡¹ç›®é“¾æ¥: [GitHub](https://github.com/ShiqinGuo/hanzi_project)

---

ï¿½ï¿½ æœ€åæ›´æ–°: 2025å¹´3æœˆ24æ—¥
